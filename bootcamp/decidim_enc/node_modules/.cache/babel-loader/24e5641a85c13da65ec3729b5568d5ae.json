{"ast":null,"code":"import AutoButtonsByPositionComponent from \"src/decidim/admin/auto_buttons_by_position.component\";\nimport AutoLabelByPositionComponent from \"src/decidim/admin/auto_label_by_position.component\";\nimport createDynamicFields from \"src/decidim/admin/dynamic_fields.component\";\nimport createSortList from \"src/decidim/admin/sort_list.component\";\n$(function () {\n  var dynamicFieldDefinitions = [{\n    placeHolderId: \"external-domain-id\",\n    wrapperSelector: \".external-domains\",\n    fieldSelector: \".external-domain\",\n    addFieldSelector: \".add-external-domain\"\n  }];\n  dynamicFieldDefinitions.forEach(function (section) {\n    var fieldSelectorSuffix = section.fieldSelector.replace(\".\", \"\");\n    var autoButtonsByPosition = new AutoButtonsByPositionComponent({\n      listSelector: \"\".concat(section.fieldSelector, \":not(.hidden)\"),\n      hideOnFirstSelector: \".move-up-question\",\n      hideOnLastSelector: \".move-down-question\"\n    });\n    var autoLabelByPosition = new AutoLabelByPositionComponent({\n      listSelector: \"\".concat(section.fieldSelector, \":not(.hidden)\"),\n      labelSelector: \".card-title span:first\",\n      onPositionComputed: function onPositionComputed(el, idx) {\n        $(el).find(\"input[name$=\\\\[position\\\\]]\").val(idx);\n      }\n    });\n    var createSortableList = function createSortableList() {\n      createSortList(\".external-domains-list:not(.published)\", {\n        handle: \".external-domain-divider\",\n        placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n        forcePlaceholderSize: true,\n        onSortUpdate: function onSortUpdate() {\n          autoLabelByPosition.run();\n          autoButtonsByPosition.run();\n        }\n      });\n    };\n    var hideDeletedItem = function hideDeletedItem($target) {\n      var inputDeleted = $target.find(\"input[name$=\\\\[deleted\\\\]]\").val();\n      if (inputDeleted === \"true\") {\n        $target.addClass(\"hidden\");\n        $target.hide();\n\n        // Allows re-submitting of the form\n        $(\"input\", $target).removeAttr(\"required\");\n      }\n    };\n    createDynamicFields({\n      placeholderId: section.placeHolderId,\n      wrapperSelector: section.wrapperSelector,\n      containerSelector: \"\".concat(section.wrapperSelector, \"-list\"),\n      fieldSelector: section.fieldSelector,\n      addFieldButtonSelector: section.addFieldSelector,\n      removeFieldButtonSelector: \".remove-\".concat(fieldSelectorSuffix),\n      moveUpFieldButtonSelector: \".move-up-question\",\n      moveDownFieldButtonSelector: \".move-down-question\",\n      onAddField: function onAddField() {\n        createSortableList();\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      },\n      onRemoveField: function onRemoveField($field) {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n\n        // Allows re-submitting of the form\n        $(\"input\", $field).removeAttr(\"required\");\n      },\n      onMoveUpField: function onMoveUpField() {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      },\n      onMoveDownField: function onMoveDownField() {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      }\n    });\n    createSortableList();\n    $(section.fieldSelector).each(function (_idx, el) {\n      var $target = $(el);\n      hideDeletedItem($target);\n    });\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  });\n});","map":{"version":3,"mappings":"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","names":["AutoButtonsByPositionComponent","AutoLabelByPositionComponent","createDynamicFields","createSortList","$","dynamicFieldDefinitions","placeHolderId","wrapperSelector","fieldSelector","addFieldSelector","forEach","section","fieldSelectorSuffix","replace","autoButtonsByPosition","listSelector","hideOnFirstSelector","hideOnLastSelector","autoLabelByPosition","labelSelector","onPositionComputed","el","idx","find","val","createSortableList","handle","placeholder","forcePlaceholderSize","onSortUpdate","run","hideDeletedItem","$target","inputDeleted","addClass","hide","removeAttr","placeholderId","containerSelector","addFieldButtonSelector","removeFieldButtonSelector","moveUpFieldButtonSelector","moveDownFieldButtonSelector","onAddField","onRemoveField","$field","onMoveUpField","onMoveDownField","each","_idx"],"sources":["/home/alan/.rvm/gems/ruby-3.0.3/gems/decidim-admin-0.27.0/app/packs/src/decidim/admin/external_domain_whitelist.js"],"sourcesContent":["import AutoButtonsByPositionComponent from \"src/decidim/admin/auto_buttons_by_position.component\"\nimport AutoLabelByPositionComponent from \"src/decidim/admin/auto_label_by_position.component\"\nimport createDynamicFields from \"src/decidim/admin/dynamic_fields.component\"\nimport createSortList from \"src/decidim/admin/sort_list.component\"\n\n$(() => {\n  const dynamicFieldDefinitions = [\n    {\n      placeHolderId: \"external-domain-id\",\n      wrapperSelector: \".external-domains\",\n      fieldSelector: \".external-domain\",\n      addFieldSelector: \".add-external-domain\"\n    }\n  ];\n\n  dynamicFieldDefinitions.forEach((section) => {\n    const fieldSelectorSuffix = section.fieldSelector.replace(\".\", \"\");\n\n    const autoButtonsByPosition = new AutoButtonsByPositionComponent({\n      listSelector: `${section.fieldSelector}:not(.hidden)`,\n      hideOnFirstSelector: \".move-up-question\",\n      hideOnLastSelector: \".move-down-question\"\n    });\n\n    const autoLabelByPosition = new AutoLabelByPositionComponent({\n      listSelector: `${section.fieldSelector}:not(.hidden)`,\n      labelSelector: \".card-title span:first\",\n      onPositionComputed: (el, idx) => {\n        $(el).find(\"input[name$=\\\\[position\\\\]]\").val(idx);\n      }\n    });\n\n    const createSortableList = () => {\n      createSortList(\".external-domains-list:not(.published)\", {\n        handle: \".external-domain-divider\",\n        placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n        forcePlaceholderSize: true,\n        onSortUpdate: () => {\n          autoLabelByPosition.run();\n          autoButtonsByPosition.run();\n        }\n      });\n    };\n\n    const hideDeletedItem = ($target) => {\n      const inputDeleted = $target.find(\"input[name$=\\\\[deleted\\\\]]\").val();\n\n      if (inputDeleted === \"true\") {\n        $target.addClass(\"hidden\");\n        $target.hide();\n\n        // Allows re-submitting of the form\n        $(\"input\", $target).removeAttr(\"required\");\n      }\n    };\n\n    createDynamicFields({\n      placeholderId: section.placeHolderId,\n      wrapperSelector: section.wrapperSelector,\n      containerSelector: `${section.wrapperSelector}-list`,\n      fieldSelector: section.fieldSelector,\n      addFieldButtonSelector: section.addFieldSelector,\n      removeFieldButtonSelector: `.remove-${fieldSelectorSuffix}`,\n      moveUpFieldButtonSelector: \".move-up-question\",\n      moveDownFieldButtonSelector: \".move-down-question\",\n      onAddField: () => {\n        createSortableList();\n\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      },\n      onRemoveField: ($field) => {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n\n        // Allows re-submitting of the form\n        $(\"input\", $field).removeAttr(\"required\");\n      },\n      onMoveUpField: () => {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      },\n      onMoveDownField: () => {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      }\n    });\n\n    createSortableList();\n\n    $(section.fieldSelector).each((_idx, el) => {\n      const $target = $(el);\n\n      hideDeletedItem($target);\n    });\n\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  });\n});\n"]},"metadata":{},"sourceType":"module"}