{"ast":null,"code":"/* eslint-disable no-invalid-this */\n/* eslint no-unused-vars: 0 */\n/* eslint id-length: [\"error\", { \"exceptions\": [\"e\"] }] */\n\n$(function () {\n  var selectedProposalsCount = function selectedProposalsCount() {\n    return $(\".table-list .js-check-all-proposal:checked\").length;\n  };\n  var selectedProposalsNotPublishedAnswerCount = function selectedProposalsNotPublishedAnswerCount() {\n    return $(\".table-list [data-published-state=false] .js-check-all-proposal:checked\").length;\n  };\n  var selectedProposalsCountUpdate = function selectedProposalsCountUpdate() {\n    var selectedProposals = selectedProposalsCount();\n    var selectedProposalsNotPublishedAnswer = selectedProposalsNotPublishedAnswerCount();\n    if (selectedProposals === 0) {\n      $(\"#js-selected-proposals-count\").text(\"\");\n    } else {\n      $(\"#js-selected-proposals-count\").text(selectedProposals);\n    }\n    if (selectedProposals >= 2) {\n      $('button[data-action=\"merge-proposals\"]').parent().show();\n    } else {\n      $('button[data-action=\"merge-proposals\"]').parent().hide();\n    }\n    if (selectedProposalsNotPublishedAnswer > 0) {\n      $('button[data-action=\"publish-answers\"]').parent().show();\n      $(\"#js-form-publish-answers-number\").text(selectedProposalsNotPublishedAnswer);\n    } else {\n      $('button[data-action=\"publish-answers\"]').parent().hide();\n    }\n  };\n  var showBulkActionsButton = function showBulkActionsButton() {\n    if (selectedProposalsCount() > 0) {\n      $(\"#js-bulk-actions-button\").removeClass(\"hide\");\n    }\n  };\n  var hideBulkActionsButton = function hideBulkActionsButton() {\n    var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    if (selectedProposalsCount() === 0 || force === true) {\n      $(\"#js-bulk-actions-button\").addClass(\"hide\");\n      $(\"#js-bulk-actions-dropdown\").removeClass(\"is-open\");\n    }\n  };\n  var showOtherActionsButtons = function showOtherActionsButtons() {\n    $(\"#js-other-actions-wrapper\").removeClass(\"hide\");\n  };\n  var hideOtherActionsButtons = function hideOtherActionsButtons() {\n    $(\"#js-other-actions-wrapper\").addClass(\"hide\");\n  };\n  var hideBulkActionForms = function hideBulkActionForms() {\n    $(\".js-bulk-action-form\").addClass(\"hide\");\n  };\n\n  // Expose functions to make them avaialble in .js.erb templates\n  window.selectedProposalsCount = selectedProposalsCount;\n  window.selectedProposalsNotPublishedAnswerCount = selectedProposalsNotPublishedAnswerCount;\n  window.selectedProposalsCountUpdate = selectedProposalsCountUpdate;\n  window.showBulkActionsButton = showBulkActionsButton;\n  window.hideBulkActionsButton = hideBulkActionsButton;\n  window.showOtherActionsButtons = showOtherActionsButtons;\n  window.hideOtherActionsButtons = hideOtherActionsButtons;\n  window.hideBulkActionForms = hideBulkActionForms;\n  if ($(\".js-bulk-action-form\").length) {\n    hideBulkActionForms();\n    $(\"#js-bulk-actions-button\").addClass(\"hide\");\n    $(\"#js-bulk-actions-dropdown ul li button\").click(function (e) {\n      e.preventDefault();\n      var action = $(e.target).data(\"action\");\n      if (action) {\n        $(\"#js-form-\".concat(action)).submit(function () {\n          $(\".layout-content > .callout-wrapper\").html(\"\");\n        });\n        $(\"#js-\".concat(action, \"-actions\")).removeClass(\"hide\");\n        hideBulkActionsButton(true);\n        hideOtherActionsButtons();\n      }\n    });\n\n    // select all checkboxes\n    $(\".js-check-all\").change(function () {\n      $(\".js-check-all-proposal\").prop(\"checked\", $(this).prop(\"checked\"));\n      if ($(this).prop(\"checked\")) {\n        $(\".js-check-all-proposal\").closest(\"tr\").addClass(\"selected\");\n        showBulkActionsButton();\n      } else {\n        $(\".js-check-all-proposal\").closest(\"tr\").removeClass(\"selected\");\n        hideBulkActionsButton();\n      }\n      selectedProposalsCountUpdate();\n    });\n\n    // proposal checkbox change\n    $(\".table-list\").on(\"change\", \".js-check-all-proposal\", function (e) {\n      var proposalId = $(this).val();\n      var checked = $(this).prop(\"checked\");\n\n      // uncheck \"select all\", if one of the listed checkbox item is unchecked\n      if ($(this).prop(\"checked\") === false) {\n        $(\".js-check-all\").prop(\"checked\", false);\n      }\n      // check \"select all\" if all checkbox proposals are checked\n      if ($(\".js-check-all-proposal:checked\").length === $(\".js-check-all-proposal\").length) {\n        $(\".js-check-all\").prop(\"checked\", true);\n        showBulkActionsButton();\n      }\n      if ($(this).prop(\"checked\")) {\n        showBulkActionsButton();\n        $(this).closest(\"tr\").addClass(\"selected\");\n      } else {\n        hideBulkActionsButton();\n        $(this).closest(\"tr\").removeClass(\"selected\");\n      }\n      if ($(\".js-check-all-proposal:checked\").length === 0) {\n        hideBulkActionsButton();\n      }\n      $(\".js-bulk-action-form\").find(\".js-proposal-id-\".concat(proposalId)).prop(\"checked\", checked);\n      selectedProposalsCountUpdate();\n    });\n    $(\".js-cancel-bulk-action\").on(\"click\", function (e) {\n      hideBulkActionForms();\n      showBulkActionsButton();\n      showOtherActionsButtons();\n    });\n  }\n});","map":{"version":3,"mappings":"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","names":["$","selectedProposalsCount","length","selectedProposalsNotPublishedAnswerCount","selectedProposalsCountUpdate","selectedProposals","selectedProposalsNotPublishedAnswer","text","parent","show","hide","showBulkActionsButton","removeClass","hideBulkActionsButton","force","addClass","showOtherActionsButtons","hideOtherActionsButtons","hideBulkActionForms","window","click","e","preventDefault","action","target","data","submit","html","change","prop","closest","on","proposalId","val","checked","find"],"sources":["/home/alan/.rvm/gems/ruby-3.0.3/gems/decidim-proposals-0.27.0/app/packs/src/decidim/proposals/admin/proposals.js"],"sourcesContent":["/* eslint-disable no-invalid-this */\n/* eslint no-unused-vars: 0 */\n/* eslint id-length: [\"error\", { \"exceptions\": [\"e\"] }] */\n\n$(() => {\n  const selectedProposalsCount = function() {\n    return $(\".table-list .js-check-all-proposal:checked\").length\n  }\n\n  const selectedProposalsNotPublishedAnswerCount = function() {\n    return $(\".table-list [data-published-state=false] .js-check-all-proposal:checked\").length\n  }\n\n  const selectedProposalsCountUpdate = function() {\n    const selectedProposals = selectedProposalsCount();\n    const selectedProposalsNotPublishedAnswer = selectedProposalsNotPublishedAnswerCount();\n    if (selectedProposals === 0) {\n      $(\"#js-selected-proposals-count\").text(\"\")\n    } else {\n      $(\"#js-selected-proposals-count\").text(selectedProposals);\n    }\n\n    if (selectedProposals >= 2) {\n      $('button[data-action=\"merge-proposals\"]').parent().show();\n    } else {\n      $('button[data-action=\"merge-proposals\"]').parent().hide();\n    }\n\n    if (selectedProposalsNotPublishedAnswer > 0) {\n      $('button[data-action=\"publish-answers\"]').parent().show();\n      $(\"#js-form-publish-answers-number\").text(selectedProposalsNotPublishedAnswer);\n    } else {\n      $('button[data-action=\"publish-answers\"]').parent().hide();\n    }\n  }\n\n  const showBulkActionsButton = function() {\n    if (selectedProposalsCount() > 0) {\n      $(\"#js-bulk-actions-button\").removeClass(\"hide\");\n    }\n  }\n\n  const hideBulkActionsButton = function(force = false) {\n    if (selectedProposalsCount() === 0 || force === true) {\n      $(\"#js-bulk-actions-button\").addClass(\"hide\");\n      $(\"#js-bulk-actions-dropdown\").removeClass(\"is-open\");\n    }\n  }\n\n  const showOtherActionsButtons = function() {\n    $(\"#js-other-actions-wrapper\").removeClass(\"hide\");\n  }\n\n  const hideOtherActionsButtons = function() {\n    $(\"#js-other-actions-wrapper\").addClass(\"hide\");\n  }\n\n  const hideBulkActionForms = function() {\n    $(\".js-bulk-action-form\").addClass(\"hide\");\n  }\n\n  // Expose functions to make them avaialble in .js.erb templates\n  window.selectedProposalsCount = selectedProposalsCount;\n  window.selectedProposalsNotPublishedAnswerCount = selectedProposalsNotPublishedAnswerCount;\n  window.selectedProposalsCountUpdate = selectedProposalsCountUpdate;\n  window.showBulkActionsButton = showBulkActionsButton;\n  window.hideBulkActionsButton = hideBulkActionsButton;\n  window.showOtherActionsButtons = showOtherActionsButtons;\n  window.hideOtherActionsButtons = hideOtherActionsButtons;\n  window.hideBulkActionForms = hideBulkActionForms;\n\n  if ($(\".js-bulk-action-form\").length) {\n    hideBulkActionForms();\n    $(\"#js-bulk-actions-button\").addClass(\"hide\");\n\n    $(\"#js-bulk-actions-dropdown ul li button\").click(function(e) {\n      e.preventDefault();\n      let action = $(e.target).data(\"action\");\n\n      if (action) {\n        $(`#js-form-${action}`).submit(function() {\n          $(\".layout-content > .callout-wrapper\").html(\"\");\n        })\n\n        $(`#js-${action}-actions`).removeClass(\"hide\");\n        hideBulkActionsButton(true);\n        hideOtherActionsButtons();\n      }\n    })\n\n    // select all checkboxes\n    $(\".js-check-all\").change(function() {\n      $(\".js-check-all-proposal\").prop(\"checked\", $(this).prop(\"checked\"));\n\n      if ($(this).prop(\"checked\")) {\n        $(\".js-check-all-proposal\").closest(\"tr\").addClass(\"selected\");\n        showBulkActionsButton();\n      } else {\n        $(\".js-check-all-proposal\").closest(\"tr\").removeClass(\"selected\");\n        hideBulkActionsButton();\n      }\n\n      selectedProposalsCountUpdate();\n    });\n\n    // proposal checkbox change\n    $(\".table-list\").on(\"change\", \".js-check-all-proposal\", function (e) {\n      let proposalId = $(this).val()\n      let checked = $(this).prop(\"checked\")\n\n      // uncheck \"select all\", if one of the listed checkbox item is unchecked\n      if ($(this).prop(\"checked\") === false) {\n        $(\".js-check-all\").prop(\"checked\", false);\n      }\n      // check \"select all\" if all checkbox proposals are checked\n      if ($(\".js-check-all-proposal:checked\").length === $(\".js-check-all-proposal\").length) {\n        $(\".js-check-all\").prop(\"checked\", true);\n        showBulkActionsButton();\n      }\n\n      if ($(this).prop(\"checked\")) {\n        showBulkActionsButton();\n        $(this).closest(\"tr\").addClass(\"selected\");\n      } else {\n        hideBulkActionsButton();\n        $(this).closest(\"tr\").removeClass(\"selected\");\n      }\n\n      if ($(\".js-check-all-proposal:checked\").length === 0) {\n        hideBulkActionsButton();\n      }\n\n      $(\".js-bulk-action-form\").find(`.js-proposal-id-${proposalId}`).prop(\"checked\", checked);\n      selectedProposalsCountUpdate();\n    });\n\n    $(\".js-cancel-bulk-action\").on(\"click\", function (e) {\n      hideBulkActionForms()\n      showBulkActionsButton();\n      showOtherActionsButtons();\n    });\n  }\n});\n"]},"metadata":{},"sourceType":"module"}