{"ast":null,"code":"function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nvar DEFAULT_MESSAGES = {\n  correctErrors: \"There are errors on the form, please correct them.\"\n};\nvar MESSAGES = DEFAULT_MESSAGES;\nvar FormValidator = /*#__PURE__*/function () {\n  function FormValidator(form) {\n    var _this = this;\n    _classCallCheck(this, FormValidator);\n    this.$form = form;\n    this.$form.on(\"form-error.decidim\", function () {\n      _this.handleError();\n    });\n  }\n  _createClass(FormValidator, [{\n    key: \"handleError\",\n    value: function handleError() {\n      this.announceFormError();\n      $(\".is-invalid-input:first\", this.$form).focus();\n    }\n\n    /**\n     * This announces immediately to the screen reader that there are errors on\n     * the form that need to be fixed. Does not work on all screen readers but\n     * works e.g. in Windows+Firefox+NVDA and macOS+Safari+VoiceOver\n     * combinations.\n     *\n     * @returns {undefined}\n     */\n  }, {\n    key: \"announceFormError\",\n    value: function announceFormError() {\n      var $announce = $(\".sr-announce\", this.$form);\n      if ($announce.length > 0) {\n        $announce.remove();\n      }\n      $announce = $(\"<div />\");\n      $announce.attr(\"class\", \"sr-announce show-for-sr\");\n      $announce.attr(\"aria-live\", \"assertive\");\n      this.$form.prepend($announce);\n      setTimeout(function () {\n        $announce.text(MESSAGES.correctErrors);\n      }, 100);\n    }\n  }], [{\n    key: \"configureMessages\",\n    value: function configureMessages(messages) {\n      MESSAGES = $.extend(DEFAULT_MESSAGES, messages);\n    }\n  }]);\n  return FormValidator;\n}();\nexport { FormValidator as default };\n$(function () {\n  $(\"form\").each(function (_i, el) {\n    $(el).data(\"form-validator\", new FormValidator($(el)));\n  });\n  $(document).on(\"forminvalid.zf.abide\", function (_ev, form) {\n    form.trigger(\"form-error.decidim\");\n  });\n});","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,gBAAgB,GAAG;EACvBC,aAAa,EAAE;AACjB,CAAC;AACD,IAAIC,QAAQ,GAAGF,gBAAgB;AAAC,IAEXG,aAAa;EAKhC,uBAAYC,IAAI,EAAE;IAAA;IAAAC;IAChB,IAAI,CAACC,KAAK,GAAGF,IAAI;IAEjB,IAAI,CAACE,KAAK,CAACC,EAAE,CAAC,oBAAoB,EAAE,YAAM;MACxCC,KAAI,CAACC,WAAW,EAAE;IACpB,CAAC,CAAC;EACJ;EAACC;IAAAC;IAAAC,OAED,uBAAc;MACZ,IAAI,CAACC,iBAAiB,EAAE;MAExBC,CAAC,CAAC,yBAAyB,EAAE,IAAI,CAACR,KAAK,CAAC,CAACS,KAAK,EAAE;IAClD;;IAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EAPE;IAAAJ;IAAAC,OAQA,6BAAoB;MAClB,IAAII,SAAS,GAAGF,CAAC,CAAC,cAAc,EAAE,IAAI,CAACR,KAAK,CAAC;MAC7C,IAAIU,SAAS,CAACC,MAAM,GAAG,CAAC,EAAE;QACxBD,SAAS,CAACE,MAAM,EAAE;MACpB;MACAF,SAAS,GAAGF,CAAC,CAAC,SAAS,CAAC;MACxBE,SAAS,CAACG,IAAI,CAAC,OAAO,EAAE,yBAAyB,CAAC;MAClDH,SAAS,CAACG,IAAI,CAAC,WAAW,EAAE,WAAW,CAAC;MACxC,IAAI,CAACb,KAAK,CAACc,OAAO,CAACJ,SAAS,CAAC;MAE7BK,UAAU,CAAC,YAAM;QACfL,SAAS,CAACM,IAAI,CAACpB,QAAQ,CAACD,aAAa,CAAC;MACxC,CAAC,EAAE,GAAG,CAAC;IACT;EAAC;IAAAU;IAAAC,OAvCD,2BAAyBW,QAAQ,EAAE;MACjCrB,QAAQ,GAAGY,CAAC,CAACU,MAAM,CAACxB,gBAAgB,EAAEuB,QAAQ,CAAC;IACjD;EAAC;EAAA;AAAA;AAAA,SAHkBpB,aAAa;AA2ClCW,CAAC,CAAC,YAAM;EACNA,CAAC,CAAC,MAAM,CAAC,CAACW,IAAI,CAAC,UAACC,EAAE,EAAEC,EAAE,EAAK;IACzBb,CAAC,CAACa,EAAE,CAAC,CAACC,IAAI,CAAC,gBAAgB,EAAE,IAAIzB,aAAa,CAACW,CAAC,CAACa,EAAE,CAAC,CAAC,CAAC;EACxD,CAAC,CAAC;EACFb,CAAC,CAACe,QAAQ,CAAC,CAACtB,EAAE,CAAC,sBAAsB,EAAE,UAASuB,GAAG,EAAE1B,IAAI,EAAE;IACzDA,IAAI,CAAC2B,OAAO,CAAC,oBAAoB,CAAC;EACpC,CAAC,CAAC;AACJ,CAAC,CAAC","names":["DEFAULT_MESSAGES","correctErrors","MESSAGES","FormValidator","form","_classCallCheck","$form","on","_this","handleError","_createClass","key","value","announceFormError","$","focus","$announce","length","remove","attr","prepend","setTimeout","text","messages","extend","each","_i","el","data","document","_ev","trigger"],"sources":["/home/alan/.rvm/gems/ruby-3.0.3/gems/decidim-core-0.27.0/app/packs/src/decidim/form_validator.js"],"sourcesContent":["const DEFAULT_MESSAGES = {\n  correctErrors: \"There are errors on the form, please correct them.\"\n};\nlet MESSAGES = DEFAULT_MESSAGES;\n\nexport default class FormValidator {\n  static configureMessages(messages) {\n    MESSAGES = $.extend(DEFAULT_MESSAGES, messages);\n  }\n\n  constructor(form) {\n    this.$form = form;\n\n    this.$form.on(\"form-error.decidim\", () => {\n      this.handleError();\n    });\n  }\n\n  handleError() {\n    this.announceFormError();\n\n    $(\".is-invalid-input:first\", this.$form).focus();\n  }\n\n  /**\n   * This announces immediately to the screen reader that there are errors on\n   * the form that need to be fixed. Does not work on all screen readers but\n   * works e.g. in Windows+Firefox+NVDA and macOS+Safari+VoiceOver\n   * combinations.\n   *\n   * @returns {undefined}\n   */\n  announceFormError() {\n    let $announce = $(\".sr-announce\", this.$form);\n    if ($announce.length > 0) {\n      $announce.remove();\n    }\n    $announce = $(\"<div />\");\n    $announce.attr(\"class\", \"sr-announce show-for-sr\");\n    $announce.attr(\"aria-live\", \"assertive\");\n    this.$form.prepend($announce);\n\n    setTimeout(() => {\n      $announce.text(MESSAGES.correctErrors);\n    }, 100);\n  }\n}\n\n$(() => {\n  $(\"form\").each((_i, el) => {\n    $(el).data(\"form-validator\", new FormValidator($(el)));\n  });\n  $(document).on(\"forminvalid.zf.abide\", function(_ev, form) {\n    form.trigger(\"form-error.decidim\");\n  })\n});\n"]},"metadata":{},"sourceType":"module"}