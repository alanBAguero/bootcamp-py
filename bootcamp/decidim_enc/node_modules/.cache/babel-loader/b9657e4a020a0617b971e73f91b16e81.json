{"ast":null,"code":"/* eslint no-unused-vars: 0 */\nimport Tribute from \"src/decidim/vendor/tribute\";\n$(function () {\n  var $mentionContainer = $(\".js-mentions\");\n  var nodatafound = $mentionContainer.attr(\"data-noresults\");\n  var noMatchTemplate = null;\n  if (nodatafound) {\n    noMatchTemplate = function noMatchTemplate() {\n      return \"<li>\".concat(nodatafound, \"</li>\");\n    };\n  }\n\n  // Listener for the event triggered by quilljs\n  var cursor = \"\";\n  $mentionContainer.on(\"quill-position\", function (event) {\n    if (event.detail !== null) {\n      // When replacing the text content after selecting a hashtag, we only need\n      // to know the hashtag's start position as that is the point which we want\n      // to replace.\n      var quill = event.target.__quill;\n      if (quill.getText(event.detail.index - 1, 1) === \"@\") {\n        cursor = event.detail.index;\n      }\n    }\n  });\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds\n  /* eslint no-invalid-this: 0 */\n  /* eslint consistent-this: 0 */\n  /* eslint prefer-reflect: 0 */\n  var debounce = function debounce(callback, wait) {\n    var _this = this;\n    var timeout = null;\n    return function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      var context = _this;\n      clearTimeout(timeout);\n      timeout = setTimeout(function () {\n        return callback.apply(context, args);\n      }, wait);\n    };\n  };\n\n  /* eslint no-use-before-define: [\"error\", { \"variables\": false }]*/\n  var remoteSearch = function remoteSearch(text, cb) {\n    var query = \"{users(filter:{wildcard:\\\"\".concat(text, \"\\\"}){nickname,name,avatarUrl,__typename,...on UserGroup{membersCount}}}\");\n    $.post(\"/api\", {\n      query: query\n    }).then(function (response) {\n      var data = response.data.users || {};\n      cb(data);\n    }).fail(function () {\n      cb([]);\n    }).always(function () {\n      // This function runs Tribute every single time you type something\n      // So we must evalute DOM properties after each\n      var $parent = $(tribute.current.element).parent();\n      $parent.addClass(\"is-active\");\n\n      // We need to move the container to the wrapper selected\n      var $tribute = $parent.find(\".tribute-container\");\n      // Remove the inline styles, relative to absolute positioning\n      $tribute.removeAttr(\"style\");\n    });\n  };\n\n  // tribute.js docs - http://github.com/zurb/tribute\n  /* global Tribute*/\n  var tribute = new Tribute({\n    trigger: \"@\",\n    // avoid overloading the API if the user types too fast\n    values: debounce(function (text, cb) {\n      remoteSearch(text, function (users) {\n        return cb(users);\n      });\n    }, 250),\n    positionMenu: true,\n    menuContainer: null,\n    allowSpaces: true,\n    menuItemLimit: 5,\n    fillAttr: \"nickname\",\n    selectClass: \"highlight\",\n    noMatchTemplate: noMatchTemplate,\n    lookup: function lookup(item) {\n      return item.nickname + item.name;\n    },\n    selectTemplate: function selectTemplate(item) {\n      if (typeof item === \"undefined\") {\n        return null;\n      }\n      if (this.range.isContentEditable(this.current.element)) {\n        // Check quill.js\n        if ($(this.current.element).hasClass(\"ql-editor\")) {\n          var editorContainer = $(this.current.element).parent().get(0);\n          var quill = editorContainer.__quill;\n          quill.insertText(cursor - 1, \"\".concat(item.original.nickname, \" \"), Quill.sources.API);\n          // cursor position + nickname length + \"@\" sign + space\n          var position = cursor + item.original.nickname.length + 2;\n          var next = 0;\n          if (quill.getLength() > position) {\n            next = position;\n          } else {\n            next = quill.getLength() - 1;\n          }\n          // Workaround https://github.com/quilljs/quill/issues/731\n          setTimeout(function () {\n            quill.setSelection(next, 0);\n          }, 500);\n          return \"\";\n        }\n        return \"<span contenteditable=\\\"false\\\">\".concat(item.original.nickname, \"</span>\");\n      }\n      return item.original.nickname;\n    },\n    menuItemTemplate: function menuItemTemplate(item) {\n      var svg = \"\";\n      if (window.Decidim && item.original.__typename === \"UserGroup\") {\n        var iconsPath = window.Decidim.config.get(\"icons_path\");\n        svg = \"<span class=\\\"is-group\\\">\".concat(item.original.membersCount, \"x <svg class=\\\"icon--members icon\\\"><use href=\\\"\").concat(iconsPath, \"#icon-members\\\"/></svg></span>\");\n      }\n      return \"<div class=\\\"tribute-item \".concat(item.original.__typename, \"\\\">\\n      <span class=\\\"author__avatar\\\"><img src=\\\"\").concat(item.original.avatarUrl, \"\\\" alt=\\\"author-avatar\\\"></span>\\n        <strong>\").concat(item.original.nickname, \"</strong>\\n        <small>\").concat(item.original.name, \"</small>\\n        \").concat(svg, \"\\n      </div>\");\n    }\n  });\n  var setupEvents = function setupEvents($element) {\n    // DOM manipulation\n    $element.on(\"focusin\", function (event) {\n      // Set the parent container relative to the current element\n      tribute.menuContainer = event.target.parentNode;\n    });\n    $element.on(\"focusout\", function (event) {\n      var $parent = $(event.target).parent();\n      if ($parent.hasClass(\"is-active\")) {\n        $parent.removeClass(\"is-active\");\n      }\n    });\n    $element.on(\"input\", function (event) {\n      var $parent = $(event.target).parent();\n      if (tribute.isActive) {\n        // We need to move the container to the wrapper selected\n        var $tribute = $(\".tribute-container\");\n        $tribute.appendTo($parent);\n\n        // Parent adaptation\n        $parent.addClass(\"is-active\");\n      } else {\n        $parent.removeClass(\"is-active\");\n      }\n    });\n  };\n  setupEvents($mentionContainer);\n\n  // This allows external libraries (like React) to use the component\n  // by simply firing and event targeting the element where to attach Tribute\n  $(document).on(\"attach-mentions-element\", function (event, element) {\n    if (!element) {\n      return;\n    }\n    tribute.attach(element);\n    // Due a bug in Tribute, re-add menu to DOM if it has been removed\n    // See https://github.com/zurb/tribute/issues/140\n    if (tribute.menu && !document.body.contains(tribute.menu)) {\n      tribute.range.getDocument().body.appendChild(tribute.menu);\n    }\n    setupEvents($(element));\n  });\n\n  // tribute.attach($mentionContainer);\n  // Tribute needs to be attached to the `.ql-editor` element as said at:\n  // https://github.com/quilljs/quill/issues/1816\n  //\n  // For this reason we need to wait a bit for quill to initialize itself.\n  setTimeout(function () {\n    $mentionContainer.each(function (index, item) {\n      var $qlEditor = $(\".ql-editor\", item);\n      if ($qlEditor.length > 0) {\n        tribute.attach($qlEditor);\n      } else {\n        tribute.attach(item);\n      }\n    });\n  }, 1000);\n});","map":{"version":3,"mappings":"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","names":["Tribute","$","$mentionContainer","nodatafound","attr","noMatchTemplate","cursor","on","event","detail","quill","target","__quill","getText","index","debounce","callback","wait","timeout","args","context","_this","clearTimeout","setTimeout","apply","remoteSearch","text","cb","query","post","then","response","data","users","fail","always","$parent","tribute","current","element","parent","addClass","$tribute","find","removeAttr","trigger","values","positionMenu","menuContainer","allowSpaces","menuItemLimit","fillAttr","selectClass","lookup","item","nickname","name","selectTemplate","range","isContentEditable","hasClass","editorContainer","get","insertText","original","Quill","sources","API","position","length","next","getLength","setSelection","menuItemTemplate","svg","window","Decidim","__typename","iconsPath","config","membersCount","avatarUrl","setupEvents","$element","parentNode","removeClass","isActive","appendTo","document","attach","menu","body","contains","getDocument","appendChild","each","$qlEditor"],"sources":["/home/alan/.rvm/gems/ruby-3.0.3/gems/decidim-core-0.27.0/app/packs/src/decidim/input_mentions.js"],"sourcesContent":["/* eslint no-unused-vars: 0 */\nimport Tribute from \"src/decidim/vendor/tribute\"\n\n$(() => {\n  const $mentionContainer = $(\".js-mentions\");\n  const nodatafound = $mentionContainer.attr(\"data-noresults\");\n\n  let noMatchTemplate = null\n  if (nodatafound) {\n    noMatchTemplate = () => `<li>${nodatafound}</li>`;\n  }\n\n  // Listener for the event triggered by quilljs\n  let cursor = \"\";\n  $mentionContainer.on(\"quill-position\", (event) => {\n    if (event.detail !== null) {\n      // When replacing the text content after selecting a hashtag, we only need\n      // to know the hashtag's start position as that is the point which we want\n      // to replace.\n      let quill = event.target.__quill;\n      if (quill.getText(event.detail.index - 1, 1) === \"@\") {\n        cursor = event.detail.index;\n      }\n    }\n  });\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds\n  /* eslint no-invalid-this: 0 */\n  /* eslint consistent-this: 0 */\n  /* eslint prefer-reflect: 0 */\n  const debounce = function(callback, wait) {\n    let timeout = null;\n    return (...args) => {\n      const context = this;\n      clearTimeout(timeout);\n      timeout = setTimeout(() => callback.apply(context, args), wait);\n    };\n  }\n\n  /* eslint no-use-before-define: [\"error\", { \"variables\": false }]*/\n  let remoteSearch = function(text, cb) {\n    let query = `{users(filter:{wildcard:\"${text}\"}){nickname,name,avatarUrl,__typename,...on UserGroup{membersCount}}}`;\n    $.post(\"/api\", {query: query}).\n      then((response) => {\n        let data = response.data.users || {};\n        cb(data)\n      }).fail(function() {\n        cb([])\n      }).always(() => {\n      // This function runs Tribute every single time you type something\n      // So we must evalute DOM properties after each\n        const $parent = $(tribute.current.element).parent();\n        $parent.addClass(\"is-active\");\n\n        // We need to move the container to the wrapper selected\n        const $tribute = $parent.find(\".tribute-container\");\n        // Remove the inline styles, relative to absolute positioning\n        $tribute.removeAttr(\"style\");\n      })\n  };\n\n  // tribute.js docs - http://github.com/zurb/tribute\n  /* global Tribute*/\n  let tribute = new Tribute({\n    trigger: \"@\",\n    // avoid overloading the API if the user types too fast\n    values: debounce(function (text, cb) {\n      remoteSearch(text, (users) => cb(users));\n    }, 250),\n    positionMenu: true,\n    menuContainer: null,\n    allowSpaces: true,\n    menuItemLimit: 5,\n    fillAttr: \"nickname\",\n    selectClass: \"highlight\",\n    noMatchTemplate: noMatchTemplate,\n    lookup: (item) => item.nickname + item.name,\n    selectTemplate: function(item) {\n      if (typeof item === \"undefined\") {\n        return null;\n      }\n      if (this.range.isContentEditable(this.current.element)) {\n        // Check quill.js\n        if ($(this.current.element).hasClass(\"ql-editor\")) {\n          let editorContainer = $(this.current.element).parent().get(0);\n          let quill = editorContainer.__quill;\n          quill.insertText(cursor - 1, `${item.original.nickname} `, Quill.sources.API);\n          // cursor position + nickname length + \"@\" sign + space\n          let position = cursor + item.original.nickname.length + 2\n\n          let next = 0;\n          if (quill.getLength() > position) {\n            next = position\n          } else {\n            next = quill.getLength() - 1\n          }\n          // Workaround https://github.com/quilljs/quill/issues/731\n          setTimeout(function () {\n            quill.setSelection(next, 0);\n          }, 500);\n\n          return \"\"\n        }\n        return `<span contenteditable=\"false\">${item.original.nickname}</span>`;\n      }\n      return item.original.nickname;\n    },\n    menuItemTemplate: function(item) {\n      let svg = \"\";\n      if (window.Decidim && item.original.__typename === \"UserGroup\") {\n        const iconsPath =  window.Decidim.config.get(\"icons_path\");\n\n        svg = `<span class=\"is-group\">${item.original.membersCount}x <svg class=\"icon--members icon\"><use href=\"${iconsPath}#icon-members\"/></svg></span>`;\n      }\n      return `<div class=\"tribute-item ${item.original.__typename}\">\n      <span class=\"author__avatar\"><img src=\"${item.original.avatarUrl}\" alt=\"author-avatar\"></span>\n        <strong>${item.original.nickname}</strong>\n        <small>${item.original.name}</small>\n        ${svg}\n      </div>`;\n    }\n  });\n\n  let setupEvents = function($element) {\n    // DOM manipulation\n    $element.on(\"focusin\", (event) => {\n      // Set the parent container relative to the current element\n      tribute.menuContainer = event.target.parentNode;\n    });\n    $element.on(\"focusout\", (event) => {\n      let $parent = $(event.target).parent();\n\n      if ($parent.hasClass(\"is-active\")) {\n        $parent.removeClass(\"is-active\");\n      }\n    });\n    $element.on(\"input\", (event) => {\n      let $parent = $(event.target).parent();\n\n      if (tribute.isActive) {\n        // We need to move the container to the wrapper selected\n        let $tribute = $(\".tribute-container\");\n        $tribute.appendTo($parent);\n\n        // Parent adaptation\n        $parent.addClass(\"is-active\");\n      } else {\n        $parent.removeClass(\"is-active\");\n      }\n    });\n  };\n\n  setupEvents($mentionContainer);\n\n  // This allows external libraries (like React) to use the component\n  // by simply firing and event targeting the element where to attach Tribute\n  $(document).on(\"attach-mentions-element\", (event, element) => {\n    if (!element) {\n      return;\n    }\n    tribute.attach(element);\n    // Due a bug in Tribute, re-add menu to DOM if it has been removed\n    // See https://github.com/zurb/tribute/issues/140\n    if (tribute.menu && !document.body.contains(tribute.menu)) {\n      tribute.range.getDocument().body.appendChild(tribute.menu);\n    }\n    setupEvents($(element));\n  });\n\n  // tribute.attach($mentionContainer);\n  // Tribute needs to be attached to the `.ql-editor` element as said at:\n  // https://github.com/quilljs/quill/issues/1816\n  //\n  // For this reason we need to wait a bit for quill to initialize itself.\n  setTimeout(function() {\n    $mentionContainer.each((index, item) => {\n      let $qlEditor = $(\".ql-editor\", item);\n      if ($qlEditor.length > 0) {\n        tribute.attach($qlEditor);\n      } else {\n        tribute.attach(item);\n      }\n    });\n  }, 1000);\n});\n\n"]},"metadata":{},"sourceType":"module"}